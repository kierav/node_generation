function r = radius_2dTD(xy,rFactor)
%     d = sqrt((xy(:,1)-0.25-xy(:,3)+xy(:,3).^2/2).^2+(xy(:,2)-0.5*xy(:,3)).^2);
%     d = min(sqrt((xy(:,1)-0.25-xy(:,3)+xy(:,3).^2/2).^2+(xy(:,2)-0.5*xy(:,3)).^2),...
%         sqrt((xy(:,1)-0.25-xy(:,3)+xy(:,3).^2/2).^2+(xy(:,2)-1-0.5*xy(:,3)).^2));
    d = sqrt((xy(:,2)-xy(:,3)).^2+(xy(:,3)-xy(:,1)).^2+(xy(:,1)-xy(:,2)).^2)/sqrt(3);
    r = 0.035+0.015*cos(5*pi*(d+0.05));
    r(d>0.35) = 0.05;
    r(d<0.15) = 0.02;
    r = r*(rFactor/0.02);
end